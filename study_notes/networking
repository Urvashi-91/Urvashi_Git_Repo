Q 1: Why would the MAC address be wrong on the default interface on a newly created VM?
A 1: udev rules are incorrectly written -- udev sets process that looks at hardware and sets that hardware up in /dev
     udev uses persistence rules based on the MAC address of the network card. If it has an entry for eth1 with a known MAC address 
     and a card appears with a different MAC address it will allocate a different ethX device name to the interface.
        To counter this, you just need to update the udev rules. 
        Edit:#vi /etc/udev/rules.d/70-persistent-net.rules --> and look for the line with your current MAC:
              SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="11:22:33:44:55:66", ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="eth*", NAME="eth0"
 
Q 2: Does DNS uses TCP?
A 2: DNS uses both TCP and UDP for valid reasons described below. UDP messages aren't larger than 512 Bytes and are truncated when greater than this size. DNS uses TCP for Zone transfer and UDP for name, 
     and queries either regular (primary) or reverse. UDP can be used to exchange small information whereas TCP must be used to exchange information larger than 512 bytes. If a client doesn't get response 
     from DNS, it must retransmit the data using TCP after 3-5 seconds of interval. Consistency is maintained using TCP.DNS uses TCP for Zone transfer and UDP for name, and queries either regular (primary) or reverse. 
       UDP can be used to exchange small information whereas TCP must be used to exchange information larger than 512 bytes.
       
Q 3: Port Range?
A 3: 0-65535 (0 is reserved for TCP, to accept connections on from clients. Some systems may require superuser privileges if the port is < 1024.)

Q 4: TCP Headers
A 4: Source/Dest Port | Seq No. | ACK No. | Data Offset (header size in multiples of 4)| Reserved (connection and data)| Flags (SYN,ACK, FIN,RST, PSH, URG, | Window (to specify sender whow much data receiver can accept)| Checksum | urgent Pointer (urgent data)| Options (MSS-Max Segment Size, Window Scaling, Selective ACK, TS, Nop)| Padding (0's that ensure TCPHeader ends and data begins on a 32 bit boundary)
     MTU: IPHeader + TCP Header + DATA(MMU)
     MMU: DATA
     TS: Timestamp after which re-attempt to send a packet happens
     PSH: All data sent, URG: Only urgent data deliver
     
Q 5: IP Header
A 5: Version | HEader LEngth | Type of Service | Total Length | Identification (identify fragments of an IP datagram) | IP Flags (Bit 0-reserved, Bit 1-donot fragment, Bit 2-more fragments), Fragment Offset, TTL, Protocol, Header Checksum, Src/Dest Address, IP Options, Data)

Q 6: IPSEC Tunnel and Phases?
A 6: support secure communication as packets of information are transported from an IP address across network boundaries and vice versa.
     VPN connections (Virtual Private Connection) - Intra, Extranet, Remote VPNs
     IPSec has three distinct phases:
          In the first phase, initial authentication takes place. Both end points confirm who they are. This process can be done by LDAP, PKI or by exchange of a shared secret, which is a hash of a pre-programmed password. When a shared secret is used, IKE (Internet Key Exchange) handles the negotiation using UDP/500.
          In phase Two, the parameters of the VPN are negotiated. The two end points negotiate things like encryption types, security services (ESP or AH or combination) and how often encryption keys are created. 
*ESP uses protocol 50 and AH uses protocol 51.
          In phase Three the VPN is initialized and data is transferred securely. 
     
Q 7: OSPF (App Layer)
A 7: Open Shortest Path First (OSPF) is a routing protocol for Internet Protocol (IP) networks. It uses a link state routing (LSR) algorithm and falls into the group of interior gateway protocols (IGPs), operating within a single autonomous system (AS). ... OSPF is a widely used IGP in large enterprise networks.
     OSPF is a routing protocol. Two routers speaking OSPF to each other exchange information about the routes they know about and the cost for them to get there. ... OSPF routers rely on cost to compute the shortest path through the network between themselves and a remote router or network destination.

Q 8: BGP (App Layer)
A 8: Border Gateway Protocol (BGP) is the postal service of the Internet. When someone drops a letter into a mailbox, the postal service processes that piece of mail and chooses a fast, efficient route to deliver that letter to its recipient. Similarly, when someone submits data across the Internet, BGP is responsible for looking at all of the available paths that data could travel and picking the best route, which usually means hopping between autonomous systems.
     BGP allows different autonomous systems on the Internet to share routing information. The gateways of autonomous systems are called Autonomous System Boundary Routers (ASBR). ... BGP allows each peer to collect routing information from its neighboring peer and later advertise that information, in its entirety, further.
     
Q 9: PKI
A 9: Public Key Infrastructure (PKI) is a system of processes, technologies, and policies that allows you to encrypt and sign data. You can issue digital certificates that authenticate the identity of users, devices, or services.
      works by using two different cryptographic keys: a public key and a private key. ... By using a two-key encryption system, PKI secures sensitive electronic information as it is passed back and forth between two parties, and provides each party with a key to encrypt and decrypt the digital data.
      An SSL certificate resides on a secure server and is used to encrypt the data that identifies the server. ... PKI uses a cryptographic key pair that it gets and shares through a trusted authority called a Certificate Authority (CA).
      
Q 10: MITM
A 10: A man-in-the-middle attack is a type of eavesdropping attack, where attackers interrupt an existing conversation or data transfer. After inserting themselves in the "middle" of the transfer, the attackers pretend to be both legitimate participants.

Q 11: Can DHCP work on Layer 2?
A 11: Layer 2/3 and Layer 7, An interface on a Palo Alto Networks firewall can perform the role of a DHCP server, client, or relay agent. The interface of a DHCP server or relay agent must be a Layer 3 Ethernet, Aggregated Ethernet, or Layer 3 VLAN interface.

Q 12: Ping
A 12: Ping uses ICMP to identify Echo-request(Query) and Round Trip Time (Timestamp)

Q 13: DoS vs DDoS?
A 13: A DoS attack is a denial of service attack where a computer is used to flood a server with TCP and UDP packets. A DDoS attack is where multiple systems target a single system with a DoS attack. The targeted network is then bombarded with packets from multiple locations.

Q 14: Fragmentation?
A 14: IP fragmentation is an Internet Protocol (IP) process that breaks packets into smaller pieces (fragments), so that the resulting pieces can pass through a link with a smaller maximum transmission unit (MTU) than the original packet size. The fragments are reassembled by the receiving host.

Q 15: Traceroute?
A 15: “traceroute works by setting the time-to-live field (TTL, actually “hop count to live”) of an outbound packet to an artificially low number. As packets arrive at a gateway, their TTL is decreased. When a gateway decreases the TTL to 0, it discards the packet and sends an ICMP “time exceeded” message back to the originating host.”
      “The first gateway to see such a packet (lab-gw in this case) determines that the TTL has been exceeded and notifies jaguar of the dropped packet by sending back an ICMP message. The sender’s IP address in the header of the error packet identifies the gateway, and traceroute looks up this address in DNS to find the gateway’s hostname.”
      Firewall Allow: “UDP ports 33434–33534 as well as ICMP ECHO (type 8) packets.”

Q 16: TLS Handshake (https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/)
A 16: HTTPS interaction over TLS. Happens after TCP connection
          - Specify version of TLS to ube used
          - Decide cipher suites to use
          - Identify identity via server's public key and the SSL certificate authority's digital signature
          - Generate session keys in order to use symmetric encryption after the handshake is complete.
 Q 17: PDU?
 A 17: A PDU is composed of protocol-specific control information and user data. In the layered architectures of communication protocol stacks, each layer implements protocols tailored to the specific type or mode of data exchange.
 
 Q 18: What is the source IP of an end user node requesting a DHCP packet?
 A 18: The Source address is the DHCP server IP address, and the Destination address is still 255.255. 255.255. The YIADDR field contains the client's address, and the CHADDR and DHCP: Client Identifier fields are the physical address of the network card in the requesting client.
 
 Q 19: ARP vs Gratuitous ARP?
 A 19: A Gratuitous ARP is an ARP Response that was not prompted by an ARP Request. The Gratuitous ARP is sent as a broadcast, as a way for a node to announce or update its IP to MAC mapping to the entire network.
          Gratuitous Address Resolution Protocol (ARP) requests help detect duplicate IP addresses. A gratuitous ARP is a broadcast request for a router's own IP address.
       ARP table: Ip-MAC (Layer 2/3) -- netstat -r -n(avoid DNS) or ip route show

Q 20: STP Spanning Tree Protocol
A 20: The Spanning Tree Protocol (STP) is a network protocol that builds a loop-free logical topology for Ethernet networks. The basic function of STP is to prevent bridge loops and the broadcast radiation that results from them. ... RSTP was designed to be backwards-compatible with standard STP.

Q 21: Firewall and Stateful Firewall?
A 21: A firewall is a network security device that monitors incoming and outgoing network traffic and permits or blocks data packets based on a set of security rules.
      S/w or H/w firewalls Packet filtering firewall (Stateful and Stateless)
          Stateless firewalls examine packets independently of one another and lack context, making them easy targets for hackers.
          stateful firewalls remember information about previously passed packets and are considered much more secure.
      Proxy, NAT, Stateful multilayer inspection firewalls
      
Q 22: Active Mode FTP and Passive Mode FTP
A 22: Active: FTP client to FTP server (Port 21), FTP server to FTP Client (port 20)
      Passive: FTP Client connects both POrt 21,20 on the server and issues PASV command.
      
Q 23: ARP table and MAC Table
A 23: ARP: IP-MAC (network level), MAC: AMC-interface (switch level)

Q 24: what is the size of a typical IP header?
A 25: The minimum length of an IP header is 20 bytes, or five 32-bit increments. The maximum length of an IP header is 24 bytes, or six 32-bit increments. Therefore, the header length field should contain either 5 or 6.

Q 26: what is NAT? sNAT, pNAT?
A 26: SNAT changes the private IP address of the source host to public IP address. It may also change the source port in the TCP/UDP headers. SNAT is typically used by internal users to access the Internet. Destination NAT changes the destination address in IP header of a packet.


Q 27: which one is more secure SSL or VPN (tricky questions as they are not mutually related)
A 27: A VPN secures all online communications coming from your device, while HTTPS only provides encryption between the website and your browser. HTTPS is vulnerable to certain attacks (like root certificate attacks) that a VPN can sometimes help protect it from.
The main difference between IPsec and SSL VPNs is the endpoints for each protocol. While an IPsec VPN allows users to connect remotely to an entire network and all its applications, SSL VPNs give users remote tunneling access to a specific system or application on the network.


Q 28: what is the difference between an HIDS and a NIDS? (security)(intrusion detection system)
A 28: HIDs examine specific host-based actions, such as what applications are being used, what files are being accessed and what information resides in the kernel logs. NIDs analyze the flow of information between computers, i.e., network traffic. They essentially "sniff" the network for suspicious behavior.

